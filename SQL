-- change dates of missing values to null
update member_a set cancel_date = NULL where cancel_date = '';
update member_a set cancel_date = str_to_date(cancel_date, '%Y-%m-%d');


-- Find rate of accounts that activate by month

WITH activations AS 
(
SELECT
	MIN(created_date) AS month,
        SUM(CASE WHEN has_activated LIKE 'Yes' THEN 1 ELSE 0 END) AS activated,
        SUM(CASE WHEN has_activated LIKE 'No' THEN 1 ELSE 0 END) AS not_activated
FROM
	member_a
GROUP BY 
	MONTH(created_date)
ORDER BY 1
)

SELECT
	activations.month,
    	(activated/(activated + not_activated)) * 100 AS activated_rate
FROM
	activations
GROUP BY 1
